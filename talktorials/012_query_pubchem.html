
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
  
    <title>Structure-based CADD using online APIs/servers &#8212; TeachOpenCADD 0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Structure-based CADD using online APIs/servers" href="015_protein_ligand_docking.html" />
    <link rel="prev" title="Structure-based CADD using online APIs/servers" href="011_query_online_api_webservices.html" />
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#talktorials/012_query_pubchem" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TeachOpenCADD 0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TeachOpenCADD (WIP 🚧)</span>
          <span class="md-header-nav__topic"> Structure-based CADD using online APIs/servers </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Our talktorials</a></li>
            
            <li class="md-tabs__item"><a href="../installing.html" class="md-tabs__link">Run locally</a></li>
            
            <li class="md-tabs__item"><a href="../contribute.html" class="md-tabs__link">Contribute</a></li>
          <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Talktorials by collection</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TeachOpenCADD 0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../index.html"
       title="TeachOpenCADD 0 documentation">TeachOpenCADD (WIP 🚧)</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Our talktorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html" class="md-nav__link">Talktorials by collection</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#jcim-2019" class="md-nav__link">JCIM 2019</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#online-apis" class="md-nav__link">Online APIs</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#structural-modeling" class="md-nav__link">Structural modeling</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../all_talktorials.html" class="md-nav__link">Complete list of talktorials</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Run locally</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installing.html" class="md-nav__link">Installing</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contributors</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contribute.html" class="md-nav__link">For contributors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../api.html" class="md-nav__link">API Documentation</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-012-query-pubchem--page-root" class="md-nav__link">Structure-based CADD using online APIs/servers</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a>
        </li>
        <li class="md-nav__item"><a href="#Learning-goals" class="md-nav__link">Learning goals</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li>
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Description-of-the-pipeline-and-the-involved-webservices" class="md-nav__link">Description of the pipeline and the involved webservices</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#KLIFS" class="md-nav__link">KLIFS</a>
        </li>
        <li class="md-nav__item"><a href="#PubChem" class="md-nav__link">PubChem</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Building-the-pipeline" class="md-nav__link">Building the pipeline</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Obtaining-information-from-KLIFS" class="md-nav__link">Obtaining information from KLIFS</a>
        </li>
        <li class="md-nav__item"><a href="#Query-PubChem" class="md-nav__link">Query PubChem</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Case-study:-EGFR" class="md-nav__link">Case study: EGFR</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/012_query_pubchem.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>

<h1 id="talktorials-012-query-pubchem--page-root">Structure-based CADD using online APIs/servers<a class="headerlink" href="#talktorials-012-query-pubchem--page-root" title="Permalink to this headline">¶</a></h1>
<p>Authors: - Jaime Rodríguez-Guerra, Volkamer lab, Charité - Dominique Sydow, Volkamer lab, Charité</p>

<h2 id="Aim-of-this-talktorial">Aim of this talktorial<a class="headerlink" href="#Aim-of-this-talktorial" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>This is part A of the “Online webservices” talktorial:</p>
<ul class="simple">
<li><p><strong>11a. Querying KLIFS &amp; PubChem for potential kinase inhibitors</strong></p></li>
<li><p>11b. Docking the candidates against the target obtained in 11a</p></li>
<li><p>11c. Assessing the results and comparing against known data</p></li>
</ul>
</div></blockquote>
<p>We will query the KLIFS database to obtain a kinase structure and one inhibitor. Then we will search for similar compounds in PubChem.</p>


<h2 id="Learning-goals">Learning goals<a class="headerlink" href="#Learning-goals" title="Permalink to this headline">¶</a></h2>

<h3 id="Theory">Theory<a class="headerlink" href="#Theory" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Description of the pipeline and the involved webservices</p></li>
</ul>


<h3 id="Practical">Practical<a class="headerlink" href="#Practical" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Write the functions that will compose the pipeline</p></li>
<li><p>Case study: EGFR inhibitors</p></li>
</ul>



<h2 id="References">References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>KLIFS, a kinase-inhibitor interactions database.</p>
<ul>
<li><p>Description of the database itself (<a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/jm400378w">J. Med. Chem. (2014), 57, 2, 249-277</a>)</p></li>
<li><p>Description of the online service (<a class="reference external" href="https://doi.org/10.1093/nar/gkv1082">Nucleic Acids Res. (2016), 44, 6, D365–D371</a>)</p></li>
</ul>
</li>
<li><p>PubChem, a small compound database (<a class="reference external" href="https://academic.oup.com/nar/article/47/D1/D1102/5146201">Nucleic Acids Res. (2019), 47, D1102-1109</a>)</p></li>
<li><p>NGLView, the interactive visualizer for the Notebook (<a class="reference external" href="https://doi.org/10.1093/bioinformatics/btx789">Bioinformatics (2018), 34, 1241–124</a>)</p></li>
</ul>
<hr class="docutils"/>


<h2 id="id1">Theory<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Now that you have seen how different Python libraries can be used to query online webservices, we will build a pipeline out of online webservices!</p>

<h3 id="Description-of-the-pipeline-and-the-involved-webservices">Description of the pipeline and the involved webservices<a class="headerlink" href="#Description-of-the-pipeline-and-the-involved-webservices" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Kinase-Ligand Interaction Fingerprints and Structures database (KLIFS), developed at the Division of Medicinal Chemistry - VU University Amsterdam, is a database that provides information about the protein structure (collected from the PDB) of catalytic kinase domains and the interaction with their ligands. We can obtain the curated protein structure from this database and use the ligand information to retrieve similar ligands from other databases, like PubChem or ChEMBL.</p></li>
<li><p>Using the ligand information provided by KLIFS, we can query PubChem for similar compounds.</p></li>
<li><p>After having obtained the protein structure(s) and several candidate ligands, we can dock them online with the Vina installation provided in the OPAL web services. We will also query <em>proteins.plus’</em> DoGSiteScorer for probable binding sites where we will dock the compounds. (part B)</p></li>
<li><p>The results will be visualized with <code class="docutils literal notranslate"><span class="pre">nglview</span></code> and their interactions reported with <a class="reference external" href="https://github.com/ssalentin/plip">PLIP</a>. (part C)</p></li>
</ol>
<p>In this part (A) of the talktorial, we will obtain input kinase-inhibitor structures from the <em>KLIFS</em> database and query <em>PubChem</em> for similar compounds that could be tested as potential inhibitors. Relevant output will be written to disk at <code class="docutils literal notranslate"><span class="pre">data/</span></code> so we can use it later on.</p>

<h4 id="KLIFS">KLIFS<a class="headerlink" href="#KLIFS" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Role: Kinase-ligand interaction profiles database</p></li>
<li><p>Website: <a class="reference external" href="http://klifs.vu-compmedchem.nl/">http://klifs.vu-compmedchem.nl/</a></p></li>
<li><p>API: Yes, REST-based, Swagger-enabled. No official client. Use <code class="docutils literal notranslate"><span class="pre">bravado</span></code>.</p></li>
<li><p>Documentation: <a class="reference external" href="http://klifs.vu-compmedchem.nl/swagger/">http://klifs.vu-compmedchem.nl/swagger/</a></p></li>
<li><p>Literature:</p>
<ul>
<li><p>Description of the database itself (<a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/jm400378w">J. Med. Chem. (2014), 57, 2, 249-277</a>)</p></li>
<li><p>Description of the online service (<a class="reference external" href="https://doi.org/10.1093/nar/gkv1082">Nucleic Acids Res. (2016), 44, 6, D365–D371</a>)</p></li>
</ul>
</li>
</ul>
<blockquote>
<div><p>Kinase-Ligand Interaction Fingerprints and Structures database (KLIFS), developed at the Division of Medicinal Chemistry - VU University Amsterdam, is a database that revolves around the protein structure of catalytic kinase domains and the way kinase inhibitors can interact with them. Based on the underlying systematic and consistent protocol all (currently human and mouse) kinase structures and the binding mode of kinase ligands can be directly compared to each other. Moreover, because of
the classification of an all-encompassing binding site of 85 residues it is possible to compare the interaction patterns of kinase-inhibitors to each other to, for example, identify crucial interactions determining kinase-inhibitor selectivity.</p>
</div></blockquote>


<h4 id="PubChem">PubChem<a class="headerlink" href="#PubChem" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Role: Small compounds database</p></li>
<li><p>Website: <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/">https://pubchem.ncbi.nlm.nih.gov/</a></p></li>
<li><p>API: Yes, REST-based. No official client. Use <code class="docutils literal notranslate"><span class="pre">bravado</span></code>.</p></li>
<li><p>Documentation: <a class="reference external" href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest">https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest</a></p></li>
<li><p>Literature:</p>
<ul>
<li><p><a class="reference external" href="https://academic.oup.com/nar/article/47/D1/D1102/5146201">Nucleic Acids Res. (2019), 47, D1102-1109</a></p></li>
</ul>
</li>
</ul>
<blockquote>
<div><p>PubChem is an open chemistry database at the National Institutes of Health (NIH). “Open” means that you can put your scientific data in PubChem and that others may use it. Since the launch in 2004, PubChem has become a key chemical information resource for scientists, students, and the general public. Each month our website and programmatic services provide data to several million users worldwide.</p>
</div></blockquote>



<hr class="docutils"/>

<h2 id="id2">Practical<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>

<h3 id="Building-the-pipeline">Building the pipeline<a class="headerlink" href="#Building-the-pipeline" title="Permalink to this headline">¶</a></h3>

<h4 id="Obtaining-information-from-KLIFS">Obtaining information from KLIFS<a class="headerlink" href="#Obtaining-information-from-KLIFS" title="Permalink to this headline">¶</a></h4>
<p>Choose a random kinase from a random family (in <code class="docutils literal notranslate"><span class="pre">mol2</span></code>) and the corresponding ligands (<code class="docutils literal notranslate"><span class="pre">SMILES</span></code>) from the KLIFS database. We will also obtain the PDB structure of the protein-ligand complex so we can calculate the binding pockets in part B.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">bravado.client</span> <span class="kn">import</span> <span class="n">SwaggerClient</span>

<span class="n">KLIFS_API_DEFINITIONS</span> <span class="o">=</span> <span class="s2">"http://klifs.vu-compmedchem.nl/swagger/swagger.json"</span>
<span class="n">KLIFS_CLIENT</span> <span class="o">=</span> <span class="n">SwaggerClient</span><span class="o">.</span><span class="n">from_url</span><span class="p">(</span><span class="n">KLIFS_API_DEFINITIONS</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="p">{</span><span class="s2">"validate_responses"</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_all_kinase_families</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">KLIFS_CLIENT</span><span class="o">.</span><span class="n">Information</span><span class="o">.</span><span class="n">get_kinase_families</span><span class="p">()</span><span class="o">.</span><span class="n">response</span><span class="p">()</span><span class="o">.</span><span class="n">result</span>


<span class="k">def</span> <span class="nf">_kinases_from_family</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="s2">"HUMAN"</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">KLIFS_CLIENT</span><span class="o">.</span><span class="n">Information</span><span class="o">.</span><span class="n">get_kinase_names</span><span class="p">(</span><span class="n">kinase_family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>
        <span class="o">.</span><span class="n">response</span><span class="p">()</span>
        <span class="o">.</span><span class="n">result</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_protein_and_ligand_structure</span><span class="p">(</span><span class="o">*</span><span class="n">kinase_ids</span><span class="p">):</span>
    <span class="n">structures</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">KLIFS_CLIENT</span><span class="o">.</span><span class="n">Structures</span><span class="o">.</span><span class="n">get_structures_list</span><span class="p">(</span><span class="n">kinase_ID</span><span class="o">=</span><span class="n">kinase_ids</span><span class="p">)</span><span class="o">.</span><span class="n">response</span><span class="p">()</span><span class="o">.</span><span class="n">result</span>
    <span class="p">)</span>
    <span class="n">molcomplex</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">KLIFS_CLIENT</span><span class="o">.</span><span class="n">Structures</span><span class="o">.</span><span class="n">get_structure_get_pdb_complex</span><span class="p">(</span>
            <span class="n">structure_ID</span><span class="o">=</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">structure_ID</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">response</span><span class="p">()</span>
        <span class="o">.</span><span class="n">result</span>
    <span class="p">)</span>
    <span class="n">protein</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">KLIFS_CLIENT</span><span class="o">.</span><span class="n">Structures</span><span class="o">.</span><span class="n">get_structure_get_protein</span><span class="p">(</span><span class="n">structure_ID</span><span class="o">=</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">structure_ID</span><span class="p">)</span>
        <span class="o">.</span><span class="n">response</span><span class="p">()</span>
        <span class="o">.</span><span class="n">result</span>
    <span class="p">)</span>
    <span class="n">ligands</span> <span class="o">=</span> <span class="n">KLIFS_CLIENT</span><span class="o">.</span><span class="n">Ligands</span><span class="o">.</span><span class="n">get_ligands_list</span><span class="p">(</span><span class="n">kinase_ID</span><span class="o">=</span><span class="n">kinase_ids</span><span class="p">)</span><span class="o">.</span><span class="n">response</span><span class="p">()</span><span class="o">.</span><span class="n">result</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">"Chosen KLIFS entry with PDB ID </span><span class="si">{</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pdb</span><span class="si">}</span><span class="s2"> with chain </span><span class="si">{</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">chain</span><span class="si">}</span><span class="s2"> and alternate model </span><span class="si">{</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">alt</span><span class="si">}</span><span class="s2">"</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">molcomplex</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="p">[</span><span class="n">ligand</span><span class="o">.</span><span class="n">SMILES</span> <span class="k">for</span> <span class="n">ligand</span> <span class="ow">in</span> <span class="n">ligands</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">def</span> <span class="nf">random_kinase_structure</span><span class="p">():</span>
    <span class="sd">"""</span>
<span class="sd">    Get a random kinase from a random family</span>
<span class="sd">    """</span>
    <span class="n">attempts</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">families</span> <span class="o">=</span> <span class="n">_all_kinase_families</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">attempts</span><span class="p">:</span>  <span class="c1"># some kinase IDs do not have a structure available</span>
        <span class="n">family</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">families</span><span class="p">)</span>
        <span class="n">kinase</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">_kinases_from_family</span><span class="p">(</span><span class="n">family</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">molcomplex</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">ligands</span> <span class="o">=</span> <span class="n">_protein_and_ligand_structure</span><span class="p">(</span><span class="n">kinase</span><span class="o">.</span><span class="n">kinase_ID</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">attempts</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">"Chosen"</span><span class="p">,</span>
                <span class="n">kinase</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">"kinase with ID"</span><span class="p">,</span>
                <span class="n">kinase</span><span class="o">.</span><span class="n">kinase_ID</span><span class="p">,</span>
                <span class="s2">"from family"</span><span class="p">,</span>
                <span class="n">family</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">molcomplex</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">ligands</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Could not find a valid kinase. Try again!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">kinase_structure_from_family</span><span class="p">(</span><span class="n">family</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a kinase family name (check `_all_kinase_families()`), retrieve a random structure.</span>
<span class="sd">    """</span>
    <span class="n">attempts</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="k">while</span> <span class="n">attempts</span><span class="p">:</span>  <span class="c1"># some kinase IDs cannot be found in the structure list...</span>
        <span class="n">kinase</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">_kinases_from_family</span><span class="p">(</span><span class="n">family</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">molcomplex</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">ligands</span> <span class="o">=</span> <span class="n">_protein_and_ligand_structure</span><span class="p">(</span><span class="n">kinase</span><span class="o">.</span><span class="n">kinase_ID</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">attempts</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">"Chosen"</span><span class="p">,</span>
                <span class="n">kinase</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">"kinase with ID"</span><span class="p">,</span>
                <span class="n">kinase</span><span class="o">.</span><span class="n">kinase_ID</span><span class="p">,</span>
                <span class="s2">"from family"</span><span class="p">,</span>
                <span class="n">family</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">molcomplex</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">ligands</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Could not find a valid kinase. Try again!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<p>Let’s check if this works. Let’s say you want a random kinase from a random family, you can use <code class="docutils literal notranslate"><span class="pre">random_kinase_structure()</span></code> like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molcomplex</span><span class="p">,</span> <span class="n">protein</span><span class="p">,</span> <span class="n">ligands</span> <span class="o">=</span> <span class="n">random_kinase_structure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Chosen KLIFS entry with PDB ID 4d9t with chain A and alternate model
Chosen RPS6KA3-b kinase with ID 59 from family RSKb
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ligands</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
['O=C(OC)[C@H](C#N)CC=1N(c2ncnc(N)c2C1c3ccc(cc3)C)/C=C/CO',
 'O=C(N)[C@@H](C#N)Cc1cc(ccc1)C(=O)C=2c3c(nccc3)NC2',
 'O=C(N)[C@H](C#N)Cc1cc2c(NN=C2)cc1',
 'O=C(NC(CO)(C)C)[C@H](C#N)Cc1cc2c(NN=C2c3cc(OC)c(OC)c(OC)c3)cc1',
 'O=C(OC(C)(C)C)[C@H](C#N)CC=1N(c2ncnc(N)c2C1c3ccc(cc3)C)CCCO']
</pre></div></div>
</div>
<p>Let’s preview the protein with <code class="docutils literal notranslate"><span class="pre">nglview</span></code> and the ligands with <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>. Run the cell below first if you have not installed <code class="docutils literal notranslate"><span class="pre">nglview</span></code> yet.</p>
!pip install nglview
!nglview install
!nglview enable<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">IPythonConsole</span><span class="p">,</span>
    <span class="n">MolsToGridImage</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># Needed to show molecules</span>


<span class="k">def</span> <span class="nf">preview_molecule_contents</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">"mol2"</span><span class="p">):</span>
    <span class="c1"># This is a temporary file, it will be autodeleted</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">NGLWidget</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">ext</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>


<span class="k">def</span> <span class="nf">preview_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">multi_preview_smiles</span><span class="p">(</span><span class="o">*</span><span class="n">smiles</span><span class="p">):</span>
    <span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">s</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span><span class="si">}</span><span class="s2">..."</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>  <span class="c1"># shorten the smiles string to avoid text overlap</span>
    <span class="n">molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">MolsToGridImage</span><span class="p">(</span>
        <span class="n">molecules</span><span class="p">,</span>
        <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
        <span class="n">maxMols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">molecules</span><span class="p">),</span>
        <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">,</span>
        <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e8e5d66e7bb94fd181eb24937af1e27a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span> <span class="o">=</span> <span class="n">preview_molecule_contents</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>
<span class="n">v</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1769d4b8f9b24564af994a99b58672c9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span><span class="o">.</span><span class="n">render_image</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span><span class="o">.</span><span class="n">_display_image</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_012_query_pubchem_14_0.png" src="../_images/talktorials_012_query_pubchem_14_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">preview_smiles</span><span class="p">(</span><span class="n">ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
O=C(OC)[C@H](C#N)CC=1N(c2ncnc(N)c2C1c3ccc(cc3)C)/C=C/CO
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_012_query_pubchem_15_1.png" src="../_images/talktorials_012_query_pubchem_15_1.png"/>
</div>
</div>


<h4 id="Query-PubChem">Query PubChem<a class="headerlink" href="#Query-PubChem" title="Permalink to this headline">¶</a></h4>
<p>Use the previously obtained <code class="docutils literal notranslate"><span class="pre">SMILES</span></code> string to query similar compounds in PubChem.</p>
<blockquote>
<div><p>Tip: You can check <a class="reference external" href="https://github.com/volkamerlab/TeachOpenCADD/blob/master/talktorials/1_ChEMBL/T1_ChEMBL.ipynb">Talktorial T1</a> to see how to do a similar operation with ChEMBL database.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>


<span class="k">def</span> <span class="nf">similar_compounds_pubchem</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">n_records</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># Query PubChem for similar compounds</span>
    <span class="n">escaped_smiles</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span> <span class="s2">"."</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/similarity/smiles/</span><span class="si">{</span><span class="n">escaped_smiles</span><span class="si">}</span><span class="s2">/JSON?Threshold=</span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&amp;MaxRecords=</span><span class="si">{</span><span class="n">n_records</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">"Waiting"</span><span class="p">][</span><span class="s2">"ListKey"</span><span class="p">]</span>
    <span class="c1"># Response is async, poll every second for 25 seconds to see if it's done</span>
    <span class="n">attempts</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="k">while</span> <span class="n">attempts</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/listkey/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">/cids/JSON"</span>
        <span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">"IdentifierList"</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="n">cids</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">"IdentifierList"</span><span class="p">][</span><span class="s2">"CID"</span><span class="p">]</span>
            <span class="k">break</span>
        <span class="n">attempts</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">"Could not find matches for "</span> <span class="o">+</span> <span class="n">smiles</span><span class="p">)</span>
    <span class="c1"># We get the Compound IDs back, but we need the SMILES</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">cids</span><span class="p">))</span><span class="si">}</span><span class="s2">/property/CanonicalSMILES/JSON"</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">"CanonicalSMILES"</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">"PropertyTable"</span><span class="p">][</span><span class="s2">"Properties"</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">query_pubchem_for_similar_compounds</span><span class="p">(</span><span class="n">ligands</span><span class="p">):</span>
    <span class="c1"># Get the first ligand for the current kinase</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Look for 10 most similar compounds on pubchem</span>
    <span class="k">return</span> <span class="n">similar_compounds_pubchem</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">n_records</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Draw the obtained compounds with RDKit</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">similar_smiles</span> <span class="o">=</span> <span class="n">query_pubchem_for_similar_compounds</span><span class="p">(</span><span class="n">ligands</span><span class="p">)</span>
<span class="n">multi_preview_smiles</span><span class="p">(</span><span class="o">*</span><span class="n">similar_smiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
O=C(OC)[C@H](C#N)CC=1N(c2ncnc(N)c2C1c3ccc(cc3)C)/C=C/CO O%3DC%28OC%29%5BC%40H%5D%28C%23N%29CC%3D1N%28c2ncnc%28N%29c2C1c3ccc%28cc3%29C%29/C%3DC/CO
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_012_query_pubchem_20_1.svg" src="../_images/talktorials_012_query_pubchem_20_1.svg"/></div>
</div>



<h3 id="Case-study:-EGFR">Case study: EGFR<a class="headerlink" href="#Case-study:-EGFR" title="Permalink to this headline">¶</a></h3>
<p>Adapted from <a class="reference external" href="https://en.wikipedia.org/wiki/Epidermal_growth_factor_receptor">the corresponding Wikipedia article</a>:</p>
<blockquote>
<div><p>The epidermal growth factor receptor (EGFR) is a member of the ErbB family of receptors, a subfamily of four closely related receptor tyrosine kinases: EGFR (ErbB-1), HER2/neu (ErbB-2), Her 3 (ErbB-3) and Her 4 (ErbB-4). In many cancer types, mutations affecting EGFR expression or activity could result in cancer.</p>
<p>Deficient signaling of the EGFR and other receptor tyrosine kinases in humans is associated with diseases such as Alzheimer’s, while over-expression is associated with the development of a wide variety of tumors. Interruption of EGFR signalling, either by blocking EGFR binding sites on the extracellular domain of the receptor or by inhibiting intracellular tyrosine kinase activity, can prevent the growth of EGFR-expressing tumours and improve the patient’s condition.</p>
</div></blockquote>
<p>As a result, we are interested in finding potential inhibitors that can target members of the EGFR family. Let’s repeat the same steps as above, but now targeting this specific family.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">egfr_molcomplex</span><span class="p">,</span> <span class="n">egfr_protein</span><span class="p">,</span> <span class="n">egfr_ligands</span> <span class="o">=</span> <span class="n">kinase_structure_from_family</span><span class="p">(</span><span class="s2">"EGFR"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Chosen KLIFS entry with PDB ID 3w33 with chain A and alternate model A
Chosen EGFR kinase with ID 406 from family EGFR
</pre></div></div>
</div>
<p>Preview protein:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span> <span class="o">=</span> <span class="n">preview_molecule_contents</span><span class="p">(</span><span class="n">egfr_protein</span><span class="p">)</span>
<span class="n">v</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "04197435c32e467a99c920c79559cfd8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span><span class="o">.</span><span class="n">render_image</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span><span class="o">.</span><span class="n">_display_image</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_012_query_pubchem_26_0.png" src="../_images/talktorials_012_query_pubchem_26_0.png"/>
</div>
</div>
<p>Preview EGFR ligand (ATP):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">preview_smiles</span><span class="p">(</span><span class="n">egfr_ligands</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P(=O)(OP(=O)(O)O)(OC[C@H]1O[C@@H](N2c3ncnc(N)c3N=C2)[C@H](O)[C@@H]1O)O
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_012_query_pubchem_28_1.png" src="../_images/talktorials_012_query_pubchem_28_1.png"/>
</div>
</div>
<p>Preview similar ligands:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">similar_smiles_egfr</span> <span class="o">=</span> <span class="n">query_pubchem_for_similar_compounds</span><span class="p">(</span><span class="n">egfr_ligands</span><span class="p">)</span>
<span class="n">multi_preview_smiles</span><span class="p">(</span><span class="o">*</span><span class="n">similar_smiles_egfr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
P(=O)(OP(=O)(O)O)(OC[C@H]1O[C@@H](N2c3ncnc(N)c3N=C2)[C@H](O)[C@@H]1O)O P%28%3DO%29%28OP%28%3DO%29%28O%29O%29%28OC%5BC%40H%5D1O%5BC%40%40H%5D%28N2c3ncnc%28N%29c3N%3DC2%29%5BC%40H%5D%28O%29%5BC%40%40H%5D1O%29O
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_012_query_pubchem_30_1.svg" src="../_images/talktorials_012_query_pubchem_30_1.svg"/></div>
</div>
<p>Write results to disk for the next part of the talktorial!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"data/similar_smiles.txt"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">similar_smiles_egfr</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"data/protein.mol2"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">egfr_protein</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"data/complex.pdb"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">egfr_molcomplex</span><span class="p">)</span>
</pre></div>
</div>
</div>


<hr class="docutils"/>

<h2 id="Discussion">Discussion<a class="headerlink" href="#Discussion" title="Permalink to this headline">¶</a></h2>
<p>In this notebook you have learned how to access and use different web services depending on the technologies available, from well documented API to handcrafted scrapers that try to mimic an actual web browser.</p>
<p>So far, we have queried the KLIFS database for members of the EGFR family, obtaining a kinase structure plus (unsurprisingly) its native ligand, the ATP. Then, PubChem has provided similar compounds with more than a 75% of similarity. We will choose one of those to perform structural modeling in the next parts.</p>

<hr class="docutils"/>

<h2 id="Quiz">Quiz<a class="headerlink" href="#Quiz" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>How many kinases does KLIFS provide for the “EGFR” family?</p></li>
<li><p>Can you make the similarity search more strict?</p></li>
<li><p>Is any of the proposed candidates already an approved inhibitor? (Hint: You can <em>scrape</em> <a class="reference external" href="http://www.icoa.fr/pkidb/">PKIDB</a> and check against the list of smiles)</p></li>
</ul>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="011_query_online_api_webservices.html" title="Structure-based CADD using online APIs/servers"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Structure-based CADD using online APIs/servers </span>
              </div>
            </a>
          
          
            <a href="015_protein_ligand_docking.html" title="Structure-based CADD using online APIs/servers"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Structure-based CADD using online APIs/servers </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018-2020, Volkamer Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.3.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>